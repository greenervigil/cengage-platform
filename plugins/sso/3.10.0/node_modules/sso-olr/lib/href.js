'use strict';

var auth = require('basic-auth');

function authString(req) {
    var user = auth(req);
    return user ? user.name + (user.pass ? ':' + user.pass : '') + '@' : '';
}

module.exports = function (req) {
    return req.protocol + '://' + authString(req) + req.headers.host + req.url;
};
