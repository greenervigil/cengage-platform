{
  "_args": [
    [
      {
        "raw": "/var/lib/jenkins/jobs/CMP-Plugin-Build-trace-phrase/workspace",
        "scope": null,
        "escapedName": null,
        "name": null,
        "rawSpec": "/var/lib/jenkins/jobs/CMP-Plugin-Build-trace-phrase/workspace",
        "spec": "/var/lib/jenkins/jobs/CMP-Plugin-Build-trace-phrase/workspace",
        "type": "directory"
      },
      "/var/lib/jenkins/jobs/CMP-Plugin-Build-trace-phrase/workspace"
    ]
  ],
  "_from": "..",
  "_id": "cmp-plugin-trace-phrase@1.0.5",
  "_inCache": true,
  "_location": "/cmp-plugin-trace-phrase",
  "_phantomChildren": {},
  "_requested": {
    "raw": "/var/lib/jenkins/jobs/CMP-Plugin-Build-trace-phrase/workspace",
    "scope": null,
    "escapedName": null,
    "name": null,
    "rawSpec": "/var/lib/jenkins/jobs/CMP-Plugin-Build-trace-phrase/workspace",
    "spec": "/var/lib/jenkins/jobs/CMP-Plugin-Build-trace-phrase/workspace",
    "type": "directory"
  },
  "_requiredBy": [
    "#USER"
  ],
  "_resolved": "file:..",
  "_shasum": "25649535bcd38043c486f1d0c8a1b302a31618d4",
  "_shrinkwrap": null,
  "_spec": "/var/lib/jenkins/jobs/CMP-Plugin-Build-trace-phrase/workspace",
  "_where": "/var/lib/jenkins/jobs/CMP-Plugin-Build-trace-phrase/workspace",
  "author": {
    "name": "Craig Tataryn"
  },
  "dependencies": {
    "cmp-plugin-base": "git+http://stash.corp.web:7990/scm/cmp/cmp-plugin-base.git#1.2.1",
    "lodash": "^4.17.4"
  },
  "description": "Adds a Trace Phrase header for inclusion in logging",
  "devDependencies": {
    "artifact": "git+http://stash.corp.web:7990/scm/ag/node-client.git#0.6.2",
    "chai": "^4.1.1",
    "eslint": "^4.5.0",
    "eslint-config-standard": "^10.2.1",
    "eslint-plugin-promise": "^3.5.0",
    "eslint-plugin-standard": "^3.0.1",
    "grunt": "^1.0.1",
    "grunt-contrib-clean": "^1.1.0",
    "grunt-contrib-copy": "^1.0.0",
    "jit-grunt": "^0.10.0",
    "jsdoc": "^3.5.4",
    "leasot": "^4.10.0",
    "minami": "^1.2.3",
    "mocha": "^3.5.0",
    "nyc": "^11.1.0",
    "sinon": "^3.2.1"
  },
  "gitHead": "4b16b989ca59502632a65824daa57e6162452051",
  "license": "ISC",
  "main": "index.js",
  "name": "cmp-plugin-trace-phrase",
  "optionalDependencies": {},
  "readme": "# CMP Plugin: Cengage Trace Phrase\n\n## Purpose\n\nWhen communicating from a front-end system to a SOA back-end based, [Omnibus](http://stash.corp.web:7990/projects/SOCOM/repos/logging-utils/browse/jaxrs/src/main/java/com/cengage/socom/logging/jaxrs/ContainerTracePhraseFilter.java)\nwill inspect the HTTP header named `cengage_trace_phrase` and add its value to the [MDC](https://logback.qos.ch/manual/mdc.html).\nThis value can then be included in SOA log files for the purpose of tracing a call from the front-end to various back-end services.\n\n## Properties\n\n| property       | type            | description                                                                                                                                                             |\n|----------------|-----------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| `enabled`      | `boolean`       | Enables or disables this plugin for a path                                                                                                                              |\n| `ignored`      | `array[string]` | A list of paths that this plugin will ignore                                                                                                                            |\n| `sessionAware` | `boolean`       | Given two requests with the same `cmp-session-id`, if this property is set, the trace phrase header will remain the same                                                |\n| `headerName`   | `string`        | Allows you to change the default trace phrase header name from `cengage_trace_phrase`                                                                                   |\n| `sharedPhrase` | `boolean`       | If `sessionAware` and `headerName` is set, setting this property will ensure the same trace phrase is used across various header names for requests in the same session |\n\n## Usage\n\n**Note:** this plugin works with CMP release 5.1.x or higher, previous versions would not allow a header to be sent\nwithout a `x-cmp` prefix\n\nTo use this plugin, add it's configuration to your policy file, for example:\n\n```\n{\n    \"guid\": \"cengage-trace-phrase-0001\",\n    \"host\": \"localhost\",\n    \"plugins\": {\n      \"trace-phrase\": {\n        \"enabled\": true,\n        \"sessionAware\": true,\n        \"version\": \"1.0.3-build.1\"\n      }\n    },\n    \"paths\": {\n        \"/\": {\n            \"url\": \"http://127.0.0.1:3000/\",\n            \"plugins\": {\n                \"trace-phrase\": {\n                    \"enabled\": false\n                }\n            }\n        },\n        \"/noSession\": {\n            \"url\": \"http://127.0.0.1:3000/\",\n            \"plugins\": {\n                \"trace-phrase\": {\n                    \"sessionAware\": false\n                }\n            }\n        },\n        \"/sessionAware\": {\n            \"url\": \"http://127.0.0.1:3000/\",\n            \"plugins\": {\n                \"trace-phrase\": {\n                    \"sessionAware\": true\n                }\n            }\n        },\n        \"/diffHeader\": {\n            \"url\": \"http://127.0.0.1:3000/\",\n            \"plugins\": {\n                \"trace-phrase\": {\n                    \"headerName\": \"a_different_header_name\"\n                }\n            }\n        },\n        \"/diffHeaderSharedPhrase\": {\n            \"url\": \"http://127.0.0.1:3000/\",\n            \"plugins\": {\n                \"trace-phrase\": {\n                    \"headerName\": \"a_different_header_name\",\n                    \"sessionAware\": true,\n                    \"sharedPhrase\": true\n                }\n            }\n        }\n\n    }\n\n```\n\nThis would result in request to:\n\n| path                      | description                                                                                                                                                                                                                                                              |\n|---------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| `/`                       | No `cengage_trace_phrase` will be created as the plugin is disabled                                                                                                                                                                                                      |\n| `/noSession`              | A different `cengage_trace_phrase` header will be generated for every request                                                                                                                                                                                            |\n| `/sessionAware`           | Requests with the same `cmp-session-id` header/cookie, will cause the trace phrase header value to remain the same                                                                                                                                                       |\n| `/diffHeader`             | Default trace phrase header will be `a_different_header_name` instead of  `cengage_trace_phrase`                                                                                                                                                                         |\n| `/diffHeaderSharedPhrase` | The same trace phrase is used across various header names for requests in the same session. For instance a request to `/sessionAware` will generate the same value for `cengage_trace_phrase` as a call to `/diffHeaderSharedPhrase`'s `a_different_header_name` header  |\n\n## Result\n\nGiven the example usage above, a call to `/mySoaApi` without a `cengage_trace_phrase` header being present would result\nin a `cengage_trace_phrase` header being generated and added to the request, made up of a unique 3-word phrase.\n\nAnd now this front-end request to the `/mySoaApi` can be traced through the back-end logs (if the `cengage_trace_phrase` MDC\nis being logged)\n",
  "readmeFilename": "README.md",
  "scripts": {
    "generate-docs": "jsdoc --configure .jsdoc.json --verbose",
    "lint": "eslint ./index.js ./test/**/*.js --max-warnings 0",
    "lint:fix": "eslint --fix ./index.js ./test/**/*.js --max-warnings 0",
    "test": "nyc --reporter=cobertura --reporter=html --reporter=text ./node_modules/mocha/bin/_mocha",
    "todo": "leasot **.*js ; exit 0"
  },
  "version": "1.0.5"
}
