const basePackage = require('./package.json')

module.exports = function(pkg, schema) {
  return class BasePlugin{

    constructor(config) {
      const {root, base, interceptors} = config
      this.rootConfig    = root
      this.baseConfig    = base
      this.interceptors  = interceptors
      this.name          = pkg.name.replace(/^cmp-plugin-/, '')
      this.version       = pkg.version
      this.description   = pkg.description
      this.baseVersion   = basePackage.version

      this.setSchema(schema)

      if(this.init) {
        this.init()
      }
    }

    shouldRun(){
      return true
    }

    setSchema(schema = {}) {
      this.schema = Object.assign({}, schema, {
        title: this.name,
        description: this.description,
      })
    }
  }
}
