# Grunt Task
The node client exposes an npm module that can be used in your grunt build procces. This allows you to automatically publish an artifact during your application's build process. 

## Getting Started
This plugin requires grunt `~0.4.0`


If you haven't used [Grunt](http://gruntjs.com/) before, be sure to check out the [Getting Started](http://gruntjs.com/getting-started) guide, as it explains how to create a [Gruntfile](http://gruntjs.com/sample-gruntfile) as well as install and use Grunt plugins. Once you're familiar with that process, you may install this plugin with this command:

```
npm install artifact --save-dev
```

Once the plugin has been installed, it may be enabled inside your Gruntfile with this line of JavaScript:

```
grunt.loadNpmTasks('artifact');
```

### The dist:prepare task
The ```grunt dist:prepare``` task prepares your application to be published to artifact graph. It handles some packaging, cleanup and version incrementation of your artifact. **It is important to include this in your build process!**


### The dist:publish task
The ```grunt dist:publish``` task is where the magic happens. The contents of your application dist directory is zipped up, published to artifact graph, along with the important meta data. 


### package.json attributes
Artifact graph mines a number of properties from your `package.json` file. Some of these properties include:

- `name`: Unique lowercase name for artifact. Supports [a-z0-9_-.] (type: string)
- `version`: Unique semantic version for this artifact. See http://semver.org/ for more details. (type: string)
- `description`: Brief description of the artifact (type: string)
- `keywords`: List of keywords describing your artifact (type: array)
- `repository`: Source SCM repository (type object)


### Options
Several additional pieces of metadata can (and should) be configured in the options for the "dist" task in grunt. The following configurable options are supported at this time:

- `build`: url to the (jenkins) build that generated the artifact
- `dependencies`: other artifacts & versions your application is dependent on
- `platform`: platform your application is dependant on (eg. nodejs:10.x)
- `proxy`: paths to be configured for CMP (not yet utilized)
- `config`: application context configuration

### Sample Configuration
```
grunt.initConfig({
   dist: {
        clean: false,
        artifact: {
            build: {
                url: process.env.BUILD_URL
            },
            proxy: {
                path: '/'
            },
            dependencies: {
                'ces': 'latest'
            },
            platform: {
                'nodejs': '0.10.x'
            },
            config: {
                contexts: [{
                    name: ".awesomenodeapprc",
                    type: "application/json",
                    schema: {
                        type: "object",
                        properties: {
                            nodeEnv: {
                                type: "string"
                            },
                            port: {
                                type: "string"
                            },
                            "verboseLogging": {
                                type: "boolean",
                                "default": true
                            }
                        }
                    }
                }]
            }
        }
    }
});
```

## Useful notes
### grunt-contrib-copy
The ```grunt copy``` task is **not part of the artifact plugin** but it is very useful in packaging your code up into a distributable 'dist' directory. The docs for the  [grunt-contrib-copy plugin](https://www.npmjs.com/package/grunt-contrib-copy)  can be found on npmjs.com


### Sample project's gruntfile

See "dist" config and "dist:prepare" and "dist:publish" tasks in the following example of how this grunt task is used:
http://stash.corp.web:7990/projects/EIT/repos/hello-node-artifact/browse/Gruntfile.js

---
 
# Command Line
The node client can also be used as a command line utility. (Advanced users)

## Names
./cli.js names

## Versions
./cli.js versions --name=nb

## Resolve
./cli.js resolve --name=nb --version=latest

## Install
./cli.js install --name=nb --version=latest

## Load
./cli.js load --name=nb --version=latest

## Publish
The following command publishes ./artifact.json
./cli.js publish
